#!/bin/sed -nf
#
# animeye2rss - Converts News from www.animeye.it to an RSS feed.
#
# For usage with http://www.animeye.it/main2.asp
#
# Copyright (c) 2004 Alexander Reiter <leckse@gmx.net>
# Released under the terms of the GNU General Public License (GPL) Version 2.
# See http://www.gnu.org/ for details.

# This is a filter for http://anime.everyeye.it
# UNTESTED AS OF 2017
# Instructions:

1i\
<?xml version="1.0\" encoding=\"ISO-8859-1\"?>\
<!DOCTYPE rss PUBLIC \"-//Netscape Communications//DTD RSS 0.91//EN\"\
        "http://my.netscape.com/publish/formats/rss-0.91.dtd">\
<rss version="0.91">\
<channel>\
	<title>Animeye</title>\
	<link>http://www.animeye.it/main2.asp</link>\
	<description>Eyes on moving images</description>
s/&#8364;/EUR/g;s/&#821[67];/'/g;s/&#822[01];/"/g;s/&/\&amp;/g;s/&amp;\([^ ]\{2,7\};\)/\&\1/g;s/[ 	]*<a name="\(newsitem[0123456789,]\+\)"><\/a>/<item>\
        <link>http:\/\/www.animeye.it\/main2.asp#\1<\/link>/p;
s/^<table[^>]*> *<tr> *<td[^>]*> *<div[^>]*> *<font[^>]*>\([^<]\+\)<\/font><\/div> *<\/td> *<\/tr><\/table> *<table[^>]*> *<tr> *<td[^>]*><font[^>]*><img[^>]*>\([^<]\+\)<\/font><\/td> *<\/tr> *<tr> *<td[^>]*><font [^>]*>\(.*\)<\/font> *<\/td> *<\/tr> *<tr> *<td [^>]*> *<div[^>]*><font[^>]*>Posted by<\/font> *<a href="\([^"]\+\)">\([^<]\+\)<\/a><\/div> *<\/td> *<\/tr><\/table>/	<title>\2<\/title>\
	<description>\3<\/description>\
<\/item>/g;/description/{s/</\&lt;/g;s/>/\&gt;/g;s/&lt;\(\/\|\)\(description\|title\|item\)&gt;/<\1\2>/gp;};$i\
<\/channel>\
<\/rss>
